<!--
  revision.component.html

  Template de la page RÃ©vision.

  Structure de la page :
  =====================

  MODE LISTE :
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                       HEADER                                â”‚
  â”‚   ğŸ“š RÃ©visions          [Stats] [Commencer la session]     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚   [Aujourd'hui (5)] [Cette semaine (12)] [Tout]            â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                             â”‚
  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚   â”‚  REVISION CARD                                      â”‚  â”‚
  â”‚   â”‚  ğŸ”€ Exercice "Conditions multiples"                 â”‚  â”‚
  â”‚   â”‚  Prochain : Aujourd'hui          Intervalle: 3j     â”‚  â”‚
  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  MODE RÃ‰VISION :
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                   [1/5]  [Quitter]                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                             â”‚
  â”‚              Ã‰NONCÃ‰ DE L'EXERCICE                           â”‚
  â”‚                                                             â”‚
  â”‚    "Ã‰cris un algorithme qui vÃ©rifie si un nombre           â”‚
  â”‚     est premier."                                           â”‚
  â”‚                                                             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                             â”‚
  â”‚              [RÃ©vÃ©ler la solution]                          â”‚
  â”‚                                                             â”‚
  â”‚    --- ou aprÃ¨s rÃ©vÃ©lation ---                              â”‚
  â”‚                                                             â”‚
  â”‚              SOLUTION                                       â”‚
  â”‚                                                             â”‚
  â”‚    [ğŸ˜Ÿ Difficile]  [ğŸ˜ Correct]  [ğŸ˜Š Facile]               â”‚
  â”‚                                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Auteur: H1m0t3p3
  Date: 24 dÃ©cembre 2024
-->

<div class="revision-container">

  <!-- ========================================== -->
  <!-- MODE LISTE (par dÃ©faut) -->
  <!-- ========================================== -->
  <ng-container *ngIf="!isReviewMode">

    <!-- Header -->
    <header class="revision-header">
      <div class="header-content">
        <h1 class="page-title">ğŸ“š RÃ©visions</h1>
        <p class="page-subtitle">
          RÃ©vise rÃ©guliÃ¨rement pour ancrer les connaissances en mÃ©moire
        </p>
      </div>

      <!-- Stats rapides -->
      <div class="header-stats">
        <div class="stat-card urgent" *ngIf="stats.dueToday > 0">
          <span class="stat-icon">ğŸ”¥</span>
          <div class="stat-info">
            <span class="stat-value">{{ stats.dueToday }}</span>
            <span class="stat-label">Ã  rÃ©viser</span>
          </div>
        </div>

        <div class="stat-card">
          <span class="stat-icon">ğŸ“ˆ</span>
          <div class="stat-info">
            <span class="stat-value">{{ stats.retentionRate }}%</span>
            <span class="stat-label">rÃ©tention</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Bouton dÃ©marrer session -->
    <div class="start-session-bar" *ngIf="todayRevisions.length > 0">
      <div class="session-info">
        <span class="session-icon">ğŸ¯</span>
        <div>
          <strong>{{ todayRevisions.length }} exercices</strong> Ã  rÃ©viser aujourd'hui
        </div>
      </div>
      <button class="btn-start" (click)="startReviewSession()">
        Commencer la session
      </button>
    </div>

    <!-- Message si rien Ã  rÃ©viser -->
    <div class="empty-state success" *ngIf="todayRevisions.length === 0 && weekRevisions.length === 0">
      <span class="empty-icon">ğŸ‰</span>
      <h3>Tout est Ã  jour !</h3>
      <p>Tu n'as rien Ã  rÃ©viser pour le moment. Reviens plus tard !</p>
    </div>

    <!-- Onglets -->
    <nav class="revision-tabs" *ngIf="todayRevisions.length > 0 || weekRevisions.length > 0">
      <button
        class="tab-btn"
        [class.active]="activeTab === 'today'"
        (click)="setActiveTab('today')">
        Aujourd'hui
        <span class="tab-badge urgent" *ngIf="todayRevisions.length > 0">
          {{ todayRevisions.length }}
        </span>
      </button>

      <button
        class="tab-btn"
        [class.active]="activeTab === 'week'"
        (click)="setActiveTab('week')">
        Cette semaine
        <span class="tab-badge" *ngIf="weekRevisions.length > 0">
          {{ weekRevisions.length }}
        </span>
      </button>
    </nav>

    <!-- Liste des rÃ©visions -->
    <div class="revision-list">

      <!-- Aujourd'hui -->
      <ng-container *ngIf="activeTab === 'today'">
        <div
          *ngFor="let item of todayRevisions"
          class="revision-card"
          [class.overdue]="item.isOverdue">

          <div class="revision-card-header">
            <span class="type-icon">{{ getTypeIcon(item.exercise.type) }}</span>
            <div class="exercise-info">
              <h3 class="exercise-title">{{ item.exercise.title }}</h3>
              <span class="exercise-category">{{ item.exercise.category }}</span>
            </div>
            <span
              class="urgency-indicator"
              [style.background]="getUrgencyColor(item)">
            </span>
          </div>

          <div class="revision-card-body">
            <div class="revision-meta">
              <div class="meta-item">
                <span class="meta-icon">ğŸ“…</span>
                <span>{{ formatDueDate(item.dueDate) }}</span>
              </div>
              <div class="meta-item">
                <span class="meta-icon">ğŸ”„</span>
                <span>Intervalle : {{ item.interval }}j</span>
              </div>
              <div class="meta-item">
                <span class="meta-icon">ğŸ“Š</span>
                <span>{{ item.repetitions }} rÃ©visions</span>
              </div>
            </div>
          </div>

        </div>
      </ng-container>

      <!-- Cette semaine -->
      <ng-container *ngIf="activeTab === 'week'">
        <div
          *ngFor="let item of weekRevisions"
          class="revision-card">

          <div class="revision-card-header">
            <span class="type-icon">{{ getTypeIcon(item.exercise.type) }}</span>
            <div class="exercise-info">
              <h3 class="exercise-title">{{ item.exercise.title }}</h3>
              <span class="exercise-category">{{ item.exercise.category }}</span>
            </div>
          </div>

          <div class="revision-card-body">
            <div class="revision-meta">
              <div class="meta-item">
                <span class="meta-icon">ğŸ“…</span>
                <span>{{ formatDueDate(item.dueDate) }}</span>
              </div>
              <div class="meta-item">
                <span class="meta-icon">ğŸ”„</span>
                <span>Intervalle : {{ item.interval }}j</span>
              </div>
            </div>
          </div>

        </div>

        <div *ngIf="weekRevisions.length === 0" class="empty-state small">
          <p>Aucune rÃ©vision prÃ©vue cette semaine</p>
        </div>
      </ng-container>

    </div>

    <!-- Section explicative -->
    <section class="info-section">
      <h2>ğŸ’¡ Comment fonctionne la rÃ©vision espacÃ©e ?</h2>
      <div class="info-cards">
        <div class="info-card">
          <span class="info-icon">ğŸ§ </span>
          <h3>La science</h3>
          <p>
            Chaque rÃ©vision au bon moment renforce les connexions neuronales.
            Tu retiens mieux et plus longtemps !
          </p>
        </div>
        <div class="info-card">
          <span class="info-icon">ğŸ“ˆ</span>
          <h3>Les intervalles</h3>
          <p>
            J+1 â†’ J+3 â†’ J+7 â†’ J+14 â†’ J+30<br>
            L'intervalle augmente Ã  chaque succÃ¨s.
          </p>
        </div>
        <div class="info-card">
          <span class="info-icon">â­</span>
          <h3>L'auto-Ã©valuation</h3>
          <p>
            Note ta facilitÃ© aprÃ¨s chaque rÃ©vision.
            L'algorithme s'adapte Ã  ton niveau !
          </p>
        </div>
      </div>
    </section>

  </ng-container>

  <!-- ========================================== -->
  <!-- MODE RÃ‰VISION (session active) -->
  <!-- ========================================== -->
  <ng-container *ngIf="isReviewMode && currentRevision">

    <!-- Barre de progression -->
    <div class="review-progress-bar">
      <div class="progress-info">
        <span class="progress-count">{{ currentIndex + 1 }} / {{ todayRevisions.length }}</span>
        <span class="progress-title">Session de rÃ©vision</span>
      </div>
      <button class="btn-exit" (click)="exitReviewMode()">
        âœ• Quitter
      </button>
    </div>

    <!-- Carte de rÃ©vision -->
    <div class="review-card">

      <!-- Question / Ã‰noncÃ© -->
      <div class="review-question">
        <div class="question-header">
          <span class="question-type">
            {{ getTypeIcon(currentRevision.exercise.type) }}
            {{ currentRevision.exercise.category }}
          </span>
          <span class="question-difficulty">
            {{ 'â­'.repeat(getDifficultyStars(currentRevision.exercise.difficulty)) }}
          </span>
        </div>

        <h2 class="question-title">{{ currentRevision.exercise.title }}</h2>

        <div class="question-content">
          <p>{{ currentRevision.exercise.description }}</p>
        </div>

        <!-- Instructions -->
        <div class="question-instructions" *ngIf="!showAnswer">
          <p>
            <strong>Essaie de rÃ©soudre cet exercice mentalement</strong>,
            puis clique sur "RÃ©vÃ©ler la solution" pour vÃ©rifier.
          </p>
        </div>
      </div>

      <!-- Bouton rÃ©vÃ©ler -->
      <div class="reveal-section" *ngIf="!showAnswer">
        <button class="btn-reveal" (click)="revealAnswer()">
          ğŸ‘ï¸ RÃ©vÃ©ler la solution
        </button>
      </div>

      <!-- Solution (aprÃ¨s rÃ©vÃ©lation) -->
      <div class="review-answer" *ngIf="showAnswer">
        <h3>Solution</h3>
        <div class="answer-content">
          <p>{{ currentRevision.exercise.solution?.pseudoCode || currentRevision.exercise.notes || 'Solution non disponible' }}</p>
          <!-- TODO: Afficher la vraie solution de l'exercice -->
        </div>

        <!-- Auto-Ã©valuation -->
        <div class="self-evaluation">
          <p class="eval-prompt">Comment as-tu trouvÃ© ?</p>
          <div class="eval-buttons">
            <button class="eval-btn hard" (click)="rateRevision(1)">
              <span class="eval-icon">ğŸ˜Ÿ</span>
              <span class="eval-label">Difficile</span>
              <span class="eval-hint">Je dois revoir</span>
            </button>

            <button class="eval-btn medium" (click)="rateRevision(3)">
              <span class="eval-icon">ğŸ˜</span>
              <span class="eval-label">Correct</span>
              <span class="eval-hint">Quelques hÃ©sitations</span>
            </button>

            <button class="eval-btn easy" (click)="rateRevision(5)">
              <span class="eval-icon">ğŸ˜Š</span>
              <span class="eval-label">Facile</span>
              <span class="eval-hint">Aucun problÃ¨me !</span>
            </button>
          </div>
        </div>
      </div>

    </div>

  </ng-container>

</div>

<!--
  RÃ©flexions UX (style David J. Malan)
  ====================================

  1. POURQUOI deux modes distincts (liste vs rÃ©vision) ?

     SÃ‰PARATION DES PRÃ‰OCCUPATIONS :
     - Mode liste : Vue d'ensemble, planification
     - Mode rÃ©vision : Concentration totale

     En mode rÃ©vision, tu ne vois QUE l'exercice.
     Pas de distractions, pas de navigation.

  2. POURQUOI l'auto-Ã©valuation avec Ã©mojis ?

     ACCESSIBILITÃ‰ et RAPIDITÃ‰ :
     - ğŸ˜Ÿ ğŸ˜ ğŸ˜Š sont compris instantanÃ©ment
     - Pas besoin de rÃ©flÃ©chir Ã  une note numÃ©rique
     - L'Ã©valuation devient un rÃ©flexe

  3. POURQUOI montrer les "en retard" en rouge ?

     URGENCE VISUELLE :
     La couleur rouge dit "PrioritÃ© !".
     Ã‡a aide Ã  prioriser sans avoir Ã  rÃ©flÃ©chir.

  4. POURQUOI la section explicative ?

     Ã‰DUCATION de l'utilisateur :
     Si tu comprends POURQUOI tu rÃ©vises ainsi,
     tu es plus motivÃ© Ã  le faire.

     C'est le principe de David J. Malan :
     "Explain the why, not just the how."
-->
