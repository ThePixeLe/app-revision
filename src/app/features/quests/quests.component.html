<!--
  quests.component.html

  Template de la page QuÃªtes.

  Structure de la page :
  =====================

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                       HEADER                                â”‚
  â”‚   ğŸ¯ QuÃªtes                      [Stats: X/Y complÃ©tÃ©es]   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚   [Toutes] [ğŸ“… Daily] [ğŸ“† Weekly] [â­ Main] [ğŸ Bonus]     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                             â”‚
  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚   â”‚  QUEST CARD                                         â”‚  â”‚
  â”‚   â”‚  ğŸ“… QuÃªte Quotidienne       [En cours]             â”‚  â”‚
  â”‚   â”‚  "Fais 3 exercices"                                 â”‚  â”‚
  â”‚   â”‚  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 2/3                             â”‚  â”‚
  â”‚   â”‚  ğŸ† 50 XP                   â° 8h restantes         â”‚  â”‚
  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                             â”‚
  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚   â”‚  QUEST CARD (completed)                             â”‚  â”‚
  â”‚   â”‚  âœ… QuÃªte Principale                                â”‚  â”‚
  â”‚   â”‚  "MaÃ®trise les conditions"                          â”‚  â”‚
  â”‚   â”‚  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100%                            â”‚  â”‚
  â”‚   â”‚  ğŸ† 200 XP rÃ©clamÃ©s                                 â”‚  â”‚
  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Auteur: H1m0t3p3
  Date: 24 dÃ©cembre 2024
-->

<div class="quests-container">

  <!-- ========================================== -->
  <!-- HEADER -->
  <!-- ========================================== -->
  <header class="quests-header">
    <div class="header-content">
      <h1 class="page-title">ğŸ¯ QuÃªtes</h1>
      <p class="page-subtitle">Accomplis des missions pour gagner des rÃ©compenses</p>
    </div>

    <!-- Statistiques rapides -->
    <div class="header-stats">
      <div class="stat-item">
        <span class="stat-value">{{ stats.completedQuests }}/{{ stats.totalQuests }}</span>
        <span class="stat-label">ComplÃ©tÃ©es</span>
      </div>
      <div class="stat-item">
        <span class="stat-value">{{ stats.totalXPEarned }}</span>
        <span class="stat-label">XP gagnÃ©s</span>
      </div>
    </div>
  </header>

  <!-- ========================================== -->
  <!-- ONGLETS DE NAVIGATION -->
  <!-- ========================================== -->
  <nav class="quests-tabs">
    <button
      class="tab-btn"
      [class.active]="activeTab === 'all'"
      (click)="setActiveTab('all')">
      <span class="tab-icon">ğŸ“‹</span>
      <span class="tab-label">Toutes</span>
      <span class="tab-count">{{ allQuests.length }}</span>
    </button>

    <button
      class="tab-btn"
      [class.active]="activeTab === 'daily'"
      (click)="setActiveTab('daily')">
      <span class="tab-icon">ğŸ“…</span>
      <span class="tab-label">Quotidiennes</span>
      <span class="tab-count">{{ countByType('daily') }}</span>
    </button>

    <button
      class="tab-btn"
      [class.active]="activeTab === 'weekly'"
      (click)="setActiveTab('weekly')">
      <span class="tab-icon">ğŸ“†</span>
      <span class="tab-label">Hebdos</span>
      <span class="tab-count">{{ countByType('weekly') }}</span>
    </button>

    <button
      class="tab-btn"
      [class.active]="activeTab === 'main'"
      (click)="setActiveTab('main')">
      <span class="tab-icon">â­</span>
      <span class="tab-label">Principales</span>
      <span class="tab-count">{{ countByType('main') }}</span>
    </button>

    <button
      class="tab-btn"
      [class.active]="activeTab === 'side'"
      (click)="setActiveTab('side')">
      <span class="tab-icon">ğŸ</span>
      <span class="tab-label">Bonus</span>
      <span class="tab-count">{{ countByType('side') }}</span>
    </button>
  </nav>

  <!-- ========================================== -->
  <!-- LISTE DES QUÃŠTES -->
  <!-- ========================================== -->
  <div class="quests-content">

    <!-- Liste principale -->
    <div class="quests-list">

      <!-- Message si aucune quÃªte -->
      <div *ngIf="filteredQuests.length === 0" class="empty-state">
        <span class="empty-icon">ğŸ”</span>
        <h3>Aucune quÃªte trouvÃ©e</h3>
        <p>Essaie de changer les filtres ou reviens plus tard !</p>
      </div>

      <!-- Carte de quÃªte -->
      <article
        *ngFor="let quest of filteredQuests"
        class="quest-card"
        [class.locked]="quest.status === 'locked'"
        [class.completed]="quest.status === 'completed'"
        [class.in-progress]="quest.status === 'in-progress'"
        (click)="selectQuest(quest)">

        <!-- En-tÃªte de la carte -->
        <div class="quest-card-header">
          <!-- Badge de type -->
          <span
            class="quest-type-badge"
            [style.background]="getTypeColor(quest.type)">
            {{ getTypeIcon(quest.type) }} {{ getTypeLabel(quest.type) }}
          </span>

          <!-- Statut -->
          <span class="quest-status">
            {{ getStatusIcon(quest.status) }}
          </span>
        </div>

        <!-- Titre et description -->
        <div class="quest-card-body">
          <h3 class="quest-title">{{ quest.title }}</h3>
          <p class="quest-description">{{ quest.description }}</p>

          <!-- Barre de progression -->
          <div class="quest-progress" *ngIf="quest.status !== 'locked'">
            <div class="progress-bar">
              <div
                class="progress-fill"
                [style.width.%]="getProgress(quest)"
                [style.background]="getTypeColor(quest.type)">
              </div>
            </div>
            <span class="progress-text">{{ getProgressText(quest) }}</span>
          </div>
        </div>

        <!-- Footer avec rÃ©compenses et deadline -->
        <div class="quest-card-footer">
          <!-- RÃ©compense XP -->
          <div class="quest-reward">
            <span class="reward-icon">ğŸ†</span>
            <span class="reward-value">{{ quest.rewards.xp }} XP</span>
            <span *ngIf="quest.rewards.badge" class="reward-badge">
              + Badge
            </span>
          </div>

          <!-- Deadline -->
          <div class="quest-deadline" *ngIf="quest.deadline">
            <span class="deadline-icon">â°</span>
            <span class="deadline-text">{{ formatDeadline(quest.deadline) }}</span>
          </div>

          <!-- DifficultÃ© -->
          <div class="quest-difficulty">
            <span class="difficulty-stars">{{ getDifficultyStars(quest.difficulty) }}</span>
          </div>
        </div>

        <!-- Overlay pour les quÃªtes verrouillÃ©es -->
        <div *ngIf="quest.status === 'locked'" class="locked-overlay">
          <span class="locked-icon">ğŸ”’</span>
          <span class="locked-text">PrÃ©requis non remplis</span>
        </div>

      </article>

    </div>

    <!-- ========================================== -->
    <!-- PANNEAU DE DÃ‰TAILS -->
    <!-- ========================================== -->
    <aside
      class="quest-details-panel"
      [class.open]="selectedQuest !== null">

      <div *ngIf="selectedQuest" class="details-content">

        <!-- Bouton fermer -->
        <button class="close-btn" (click)="closeDetails()">
          âœ•
        </button>

        <!-- Header -->
        <div class="details-header">
          <span
            class="details-type"
            [style.color]="getTypeColor(selectedQuest.type)">
            {{ getTypeIcon(selectedQuest.type) }} {{ getTypeLabel(selectedQuest.type) }}
          </span>
          <h2 class="details-title">{{ selectedQuest.title }}</h2>
        </div>

        <!-- Description complÃ¨te -->
        <div class="details-section">
          <h4>Description</h4>
          <p>{{ selectedQuest.description }}</p>
          <p *ngIf="selectedQuest.flavor" class="flavor-text">
            "{{ selectedQuest.flavor }}"
          </p>
        </div>

        <!-- Objectif -->
        <div class="details-section">
          <h4>Objectif</h4>
          <div class="objective-display">
            <div class="objective-progress">
              <div
                class="objective-bar"
                [style.width.%]="getProgress(selectedQuest)"
                [style.background]="getTypeColor(selectedQuest.type)">
              </div>
            </div>
            <span class="objective-text">
              {{ selectedQuest.objective.current }} / {{ selectedQuest.objective.target }}
              {{ selectedQuest.objective.unit }}
            </span>
          </div>
        </div>

        <!-- RÃ©compenses -->
        <div class="details-section">
          <h4>RÃ©compenses</h4>
          <ul class="rewards-list">
            <li>
              <span class="reward-icon">âœ¨</span>
              {{ selectedQuest.rewards.xp }} XP
            </li>
            <li *ngIf="selectedQuest.rewards.badge">
              <span class="reward-icon">ğŸ†</span>
              Badge spÃ©cial
            </li>
            <li *ngIf="selectedQuest.rewards.special">
              <span class="reward-icon">ğŸ</span>
              {{ selectedQuest.rewards.special }}
            </li>
          </ul>
        </div>

        <!-- Informations -->
        <div class="details-section">
          <h4>Informations</h4>
          <ul class="info-list">
            <li>
              <span class="info-label">DifficultÃ© :</span>
              <span>{{ getDifficultyStars(selectedQuest.difficulty) }}</span>
            </li>
            <li *ngIf="selectedQuest.deadline">
              <span class="info-label">Limite :</span>
              <span>{{ formatDeadline(selectedQuest.deadline) }}</span>
            </li>
            <li *ngIf="selectedQuest.estimatedDuration">
              <span class="info-label">DurÃ©e estimÃ©e :</span>
              <span>{{ selectedQuest.estimatedDuration }} min</span>
            </li>
          </ul>
        </div>

        <!-- Actions -->
        <div class="details-actions">
          <button
            *ngIf="canStart(selectedQuest)"
            class="btn-action start"
            (click)="startQuest(selectedQuest)">
            â–¶ï¸ Commencer cette quÃªte
          </button>

          <button
            *ngIf="canClaim(selectedQuest)"
            class="btn-action claim"
            (click)="claimReward(selectedQuest)">
            ğŸ† RÃ©clamer la rÃ©compense
          </button>

          <div
            *ngIf="selectedQuest.status === 'in-progress'"
            class="in-progress-section">
            <div class="in-progress-hint">
              <span>â³</span>
              <span>Cette quÃªte est en cours. Continue !</span>
            </div>
            <button
              class="btn-action abandon"
              (click)="abandonQuest(selectedQuest)">
              ğŸš« Abandonner
            </button>
          </div>

          <div
            *ngIf="selectedQuest.status === 'locked'"
            class="locked-hint">
            <span>ğŸ”’</span>
            <span>ComplÃ¨te d'abord les quÃªtes prÃ©requises.</span>
          </div>
        </div>

      </div>
    </aside>

  </div>

</div>

<!--
  RÃ©flexions UX (style David J. Malan)
  ====================================

  1. POURQUOI les onglets par type de quÃªte ?

     Organisation mentale :
     - "Qu'est-ce que je peux faire AUJOURD'HUI ?" â†’ Daily
     - "Qu'est-ce que je dois faire CETTE SEMAINE ?" â†’ Weekly
     - "OÃ¹ j'en suis dans le PROGRAMME ?" â†’ Main

     Les onglets rÃ©pondent Ã  ces questions instantanÃ©ment.

  2. POURQUOI la barre de progression sur chaque carte ?

     Feedback visuel immÃ©diat :
     - On voit sa progression sans cliquer
     - La barre colorÃ©e attire l'Å“il
     - "Je suis Ã  80% !" â†’ Motivation pour finir

  3. POURQUOI le panneau de dÃ©tails ?

     HiÃ©rarchie de l'information :
     - La carte = Vue d'ensemble (titre, progression, rÃ©compense)
     - Le panneau = DÃ©tails complets (description, prÃ©requis, etc.)

     On ne surcharge pas les cartes avec trop d'infos.

  4. POURQUOI l'overlay sur les quÃªtes verrouillÃ©es ?

     Signal visuel clair :
     - La quÃªte est visible (tu sais qu'elle existe)
     - Mais grisÃ©e (tu sais que tu ne peux pas la faire)
     - Le cadenas explique pourquoi

     C'est le pattern "Teasing" : montrer ce qui viendra.
-->
