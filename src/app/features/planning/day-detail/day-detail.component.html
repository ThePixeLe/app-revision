<!--
  day-detail.component.html

  Template du dÃ©tail d'une journÃ©e.

  Structure :
  ==========
  - Header avec navigation (prÃ©cÃ©dent/suivant)
  - Informations du jour (titre, catÃ©gorie, progression)
  - Sessions d'Ã©tude (liste avec checkboxes)
  - Exercices du jour
  - Actions (Pomodoro, Ã©valuation)

  Auteur: H1m0t3p3
  Date: 24 dÃ©cembre 2024
-->

<div class="day-detail-container">

  <!-- Ã‰tat de chargement -->
  <div *ngIf="isLoading" class="loading-state">
    <span class="loading-spinner">â³</span>
    <p>Chargement...</p>
  </div>

  <!-- Erreur -->
  <div *ngIf="error" class="error-state">
    <span class="error-icon">âŒ</span>
    <h2>{{ error }}</h2>
    <button class="btn-back" (click)="backToPlanning()">
      â† Retour au planning
    </button>
  </div>

  <!-- Contenu principal -->
  <ng-container *ngIf="!isLoading && !error && day">

    <!-- ========================================== -->
    <!-- HEADER -->
    <!-- ========================================== -->
    <header class="day-header">

      <!-- Navigation -->
      <div class="nav-controls">
        <button
          class="nav-btn"
          [disabled]="dayNumber <= 1"
          (click)="previousDay()">
          â† Jour {{ dayNumber - 1 }}
        </button>

        <button class="back-btn" (click)="backToPlanning()">
          ğŸ“… Planning
        </button>

        <button
          class="nav-btn"
          [disabled]="dayNumber >= 12"
          (click)="nextDay()">
          Jour {{ dayNumber + 1 }} â†’
        </button>
      </div>

      <!-- Titre du jour -->
      <div class="day-title-section">
        <span
          class="day-badge"
          [style.background]="getCategoryColor()">
          Jour {{ dayNumber }}
        </span>
        <h1 class="day-title">{{ day.title }}</h1>
        <p class="day-subject">{{ day.subject | titlecase }}</p>
      </div>

      <!-- Progression -->
      <div class="progress-section">
        <div class="progress-circle" [style.--progress]="dayProgress + '%'">
          <span class="progress-value">{{ dayProgress }}%</span>
        </div>
        <div class="progress-info">
          <span class="progress-label">Progression</span>
          <span class="progress-detail">{{ getTotalDuration() }} min de travail</span>
        </div>
      </div>

    </header>

    <!-- ========================================== -->
    <!-- OBJECTIFS DU JOUR -->
    <!-- ========================================== -->
    <section class="objectives-section">
      <h2>ğŸ¯ Objectifs du jour</h2>
      <ul class="objectives-list">
        <li *ngFor="let obj of day.objectives">
          {{ obj }}
        </li>
      </ul>
    </section>

    <!-- ========================================== -->
    <!-- SESSIONS D'Ã‰TUDE -->
    <!-- ========================================== -->
    <section class="sessions-section">
      <h2>ğŸ“š Sessions d'Ã©tude</h2>

      <div class="sessions-list">
        <article
          *ngFor="let session of sessions"
          class="session-card"
          [class.completed]="session.completed"
          (click)="toggleSession(session)">

          <!-- Checkbox -->
          <div class="session-checkbox">
            <span *ngIf="session.completed" class="check-icon">âœ…</span>
            <span *ngIf="!session.completed" class="check-icon empty">â¬œ</span>
          </div>

          <!-- Contenu -->
          <div class="session-content">
            <div class="session-header">
              <span class="session-icon">{{ getSessionIcon(session.type) }}</span>
              <h3 class="session-title">{{ session.title }}</h3>
            </div>
            <p class="session-description">{{ session.description }}</p>
          </div>

          <!-- DurÃ©e -->
          <div class="session-duration">
            <span class="duration-value">{{ session.duration }}</span>
            <span class="duration-unit">min</span>
          </div>

        </article>
      </div>
    </section>

    <!-- ========================================== -->
    <!-- EXERCICES DU JOUR -->
    <!-- ========================================== -->
    <section class="exercises-section">
      <div class="section-header">
        <h2>âœï¸ Exercices</h2>
        <a routerLink="/exercises" class="view-all-link">
          Voir tous â†’
        </a>
      </div>

      <div class="exercises-list">
        <article
          *ngFor="let exercise of exercises"
          class="exercise-card"
          [class.completed]="exercise.status === 'completed'"
          (click)="goToExercise(exercise)">

          <!-- Statut -->
          <span class="exercise-status">
            <span *ngIf="exercise.status === 'completed'">âœ…</span>
            <span *ngIf="exercise.status === 'in-progress'">â³</span>
            <span *ngIf="exercise.status === 'todo'">ğŸ“</span>
          </span>

          <!-- Contenu -->
          <div class="exercise-content">
            <h3 class="exercise-title">{{ exercise.title }}</h3>
            <div class="exercise-meta">
              <span class="meta-item">{{ exercise.type }}</span>
              <span class="meta-item">{{ 'â­'.repeat(getDifficultyStars(exercise.difficulty)) }}</span>
            </div>
          </div>

          <!-- FlÃ¨che -->
          <span class="exercise-arrow">â†’</span>

        </article>

        <!-- Message si pas d'exercices -->
        <div *ngIf="exercises.length === 0" class="no-exercises">
          <p>Pas d'exercices spÃ©cifiques pour ce jour.</p>
          <a routerLink="/exercises">Parcourir tous les exercices</a>
        </div>
      </div>
    </section>

    <!-- ========================================== -->
    <!-- ACTIONS -->
    <!-- ========================================== -->
    <footer class="day-actions">
      <button class="action-btn secondary" routerLink="/evaluation">
        ğŸ“ Auto-Ã©valuation
      </button>
      <button class="action-btn primary" (click)="startPomodoro()">
        ğŸ… Lancer une session Pomodoro
      </button>
    </footer>

  </ng-container>

</div>
